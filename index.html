<!DOCTYPE html> <html lang="es"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width,initial-scale=1" /> <title>Con la Sombra de Pedro – Pista Manolo Solano</title> <style> :root{ --bg:#fbfbfb; --card:#ffffff; --accent:#ff5b2e; /* color llamativo */ --cta:#111; --muted:#666; } *{box-sizing:border-box} body{ margin:0; font-family:Inter, system-ui, Arial, sans-serif; background:var(--bg); color:#111; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; } .wrap{ max-width:560px; margin:36px auto; padding:28px; background:var(--card); border-radius:16px; box-shadow:0 10px 40px rgba(16,24,40,0.06); text-align:center; } h1{ font-size:20px; margin:0 0 6px; letter-spacing:.4px; } p.sub{ margin:0 0 14px; color:var(--muted); font-size:14px; } /* advertencia corta y clara (visible) */ .shortWarn{ display:inline-block; background: linear-gradient(90deg,#fff7ec,#fff2e6); padding:10px 12px; border-radius:10px; border: 1px solid #ffd9c1; color:#6a3b13; font-weight:700; margin:12px 0 18px; font-size:14px; } /* CTA grande y llamativa */ #verVideoBtn{ width:100%; padding:14px; background:linear-gradient(90deg,var(--accent),#ff8a5b); color:#fff; border-radius:12px; border:none; font-size:17px; font-weight:800; cursor:pointer; box-shadow:0 8px 24px rgba(255,91,46,0.18); transition:transform .12s ease, box-shadow .12s ease; } #verVideoBtn:active{ transform:translateY(1px) } #verVideoBtn:hover{ box-shadow:0 12px 30px rgba(255,91,46,0.22); } .contador{ font-size:36px; font-weight:900; margin-top:18px; display:none; color:var(--accent); } .videoBox{ margin-top:18px; display:none; } .videoFrame{ width:100%; height:320px; border-radius:12px; border:0; box-shadow:0 12px 30px rgba(0,0,0,0.08); } .downloadWrap{ margin-top:12px; display:none; align-items:center; justify-content:center; flex-direction:column; } .downloadBtn{ background:#0b5ed7; color:white; border:none; padding:12px 16px; border-radius:10px; font-weight:800; cursor:pointer; font-size:15px; } .downloadNote{ color:#666; font-size:13px; margin-top:8px; } .mutedSmall{ color:var(--muted); font-size:13px; margin-top:8px; } @media(min-width:720px){ .videoFrame{ height:380px; } .wrap{ padding:36px; } } </style> </head> <body> <!-- ====================== BACK BUTTON & PUSH (NO cargados todavía) Los incluimos *más abajo dinámicamente* tras la reproducción ====================== --> <div class="wrap" role="main" aria-live="polite"> <h1>CON LA SOMBRA DE PEDRO</h1> <p class="sub">Pista y Letra — Manolo Solano</p> <!-- Advertencia corta clara --> <div class="shortWarn" id="warn">Al pulsar se abrirá publicidad. Vuelve a esta pestaña para ver el video.</div> <!-- Botón CTA --> <button id="verVideoBtn" aria-describedby="warn">YA PUEDES VER EL VIDEO</button> <!-- Contador (aparece SOLO cuando regresan) --> <div class="contador" id="contador">5</div> <!-- Contenedor del player Rumble (se inicializa dinámicamente) --> <div class="videoBox" id="videoBox" aria-hidden="true"> <div id="rumble_v6zsmu6"></div> <div class="downloadWrap" id="downloadWrap"> <button id="downloadBtn" class="downloadBtn">⬇ Descargar 1080p</button> <div class="downloadNote" id="downloadNote">Si falla la descarga directa se abrirá una herramienta externa.</div> </div> </div> <div class="mutedSmall">Si no regresas, no verás el video. Vuelve para activarlo.</div> </div> <script> /* ============================ CONFIG (NO CAMBIAR) ============================ */ const SMARTLINK = "https://otieu.com/4/10211991"; const RUMBLE_ID = "v6zsmu6"; /* ============================ ESTADO ============================ */ let clickedAd = false; let countdownStarted = false; let rumbleInitialized = false; let backButtonLoaded = false; // cargaremos script backbutton DINAMICAMENTE después de mostrar video /* Elementos */ const btn = document.getElementById("verVideoBtn"); const contadorEl = document.getElementById("contador"); const videoBox = document.getElementById("videoBox"); const downloadWrap = document.getElementById("downloadWrap"); const downloadBtn = document.getElementById("downloadBtn"); const warn = document.getElementById("warn"); /* Manejo clic en botón */ btn.addEventListener("click", () => { // Abrir smartlink en nueva pestaña normal const w = window.open(SMARTLINK, "_blank", "noopener"); if (w) { w.blur(); window.focus(); } clickedAd = true; // Indicamos brevemente que deben volver warn.textContent = "Abierto en nueva pestaña. Vuelve a ESTA pestaña para iniciar el contador."; // ocultamos el CTA para evitar clics múltiples btn.style.display = "none"; }); /* Detectar cuando el usuario regresa a la pestaña (visibilitychange) */ document.addEventListener("visibilitychange", () => { if (!clickedAd || countdownStarted) return; // Si vuelve a la pestaña if (!document.hidden) { countdownStarted = true; startCountdownThenShowVideo(); } }); /* Contador y mostrar video (autoplay) */ function startCountdownThenShowVideo(){ let t = 5; contadorEl.style.display = "block"; contadorEl.textContent = t; const tick = setInterval(() => { t--; if (t >= 0) contadorEl.textContent = t; if (t < 0) { clearInterval(tick); contadorEl.style.display = "none"; showRumblePlayer(); // mostrar descarga downloadWrap.style.display = "flex"; // después de mostrar video cargamos push & backbutton loadPushAndBackButton(); // se carga DINÁMICAMENTE para activar backbutton a partir de ahora } }, 1000); } /* ============================ RUMBLE: inicializamos el player solo cuando se necesite Usamos el embedJS que nos proporcionaste (dinámico) ============================ */ function showRumblePlayer(){ if (rumbleInitialized){ videoBox.style.display = "block"; return; } // Mostrar contenedor videoBox.style.display = "block"; rumbleInitialized = true; // Insertar script Rumble (con la estructura que compartiste) (function(r,u,m,b,l,e){ r._Rumble=b; r[b]||(r[b]=function(){ (r[b]._=r[b]._||[]).push(arguments); if(r[b]._.length==1){ l=u.createElement(m); e=u.getElementsByTagName(m)[0]; l.async=1; // Nota: usamos el mismo patrón que nos diste; colocamos video id en el args l.src="https://rumble.com/embedJS/u4ns49a.v6zsmu6/?url="+encodeURIComponent(location.href)+"&args="+encodeURIComponent(JSON.stringify([].slice.apply(arguments))); e.parentNode.insertBefore(l,e); } }); })(window, document, "script", "Rumble"); try{ Rumble("play", {"video": RUMBLE_ID, "div": "rumble_v6zsmu6"}); } catch (err){ // podría inicializar asincrónicamente; por eso intentamos igualmente console.warn("Rumble init: ", err); } } /* ============================ DESCARGA: intento directo -> fallback externo ============================ */ downloadBtn.addEventListener("click", async () => { // Intento directo (probablemente fallará por CORS), lo intentamos igual // NOTA: rara vez funcionará directamente desde Rumble sin un proxy server-side. const probableDirectUrl = https://rumble.com/embedJS/u4ns49a.${RUMBLE_ID}/video.mp4; // hipotético try { const resp = await fetch(probableDirectUrl, { mode: 'cors' }); if (!resp.ok) throw new Error("No disponible directo"); const blob = await resp.blob(); const url = URL.createObjectURL(blob); const a = document.createElement("a"); a.href = url; a.download = ${RUMBLE_ID}_1080p.mp4; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url); return; } catch (err) { // Fallback: abrir generador externo automático en nueva pestaña // Usamos tu servicio (o el ejemplo) que puede pedir 1080p const fallback = https://descargarvideosinternet.com/dl.php?source=rumble&video=${encodeURIComponent(RUMBLE_ID)}&quality=1080; alert("Descarga directa no disponible. Se abrirá una herramienta externa para descargar en 1080p."); window.open(fallback, "_blank", "noopener"); } }); /* ============================ CARGA DINÁMICA: PUSH y BACK BUTTON - Mantengo tus scripts EXACTOS pero los cargo después para que no se activen antes - Esto hace que el backbutton (que depende de esos scripts) solo funcione DESPUÉS del primer regreso y la reproducción ============================ */ function loadPushAndBackButton(){ if (backButtonLoaded) return; backButtonLoaded = true; // 1) Cargar script de back button (tal como nos diste) const backScript1 = document.createElement("script"); backScript1.text = 'var Back_Button_Zone = 10215704; var Domain_TB = "rel-s.com";'; document.head.appendChild(backScript1); const backScript2 = document.createElement("script"); backScript2.async = true; backScript2.src = "https://p2pdh.com/bfc/2626c/reverse.min.js?sf=1"; document.head.appendChild(backScript2); // 2) Cargar push/tag script (tal como nos diste) const pushScript = document.createElement("script"); pushScript.async = true; pushScript.src = "https://3nbf4.com/act/files/tag.min.js?z=10215539"; pushScript.setAttribute("data-cfasync", "false"); document.head.appendChild(pushScript); // opcional: actualizamos advertencia warn.textContent = "¡Listo! Disfruta el video. Si presionas atrás ahora puede activarse tu back button."; } /* ============================ NOTAS FINALES ============================ */ </script> </body> </html>
